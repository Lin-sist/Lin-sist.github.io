---
title: Day08-01åˆ°11ã€Šç”¨æˆ·ä¸‹å•ã€‹
tags: [ä¸€åˆ·è‹ç©¹å¤–å–]
date: 2026-01-31
---

# ğŸ“š æ ¸å¿ƒä¸šåŠ¡æ¨¡å—è¯¦è§£

- [[Day08-12åˆ°18ã€Šè®¢å•æ”¯ä»˜ã€‹]]

## ä¸€ã€åœ°å€ç°¿æ¨¡å—

### 1.1 ä¸šåŠ¡æµç¨‹å›¾

```mermaid
flowchart TB
    subgraph ç”¨æˆ·æ“ä½œ
        A[ç”¨æˆ·è¿›å…¥åœ°å€ç®¡ç†] --> B{é€‰æ‹©æ“ä½œ}
        B -->|æ–°å¢| C[å¡«å†™åœ°å€ä¿¡æ¯]
        B -->|æŸ¥çœ‹| D[å±•ç¤ºåœ°å€åˆ—è¡¨]
        B -->|ä¿®æ”¹| E[ç¼–è¾‘åœ°å€]
        B -->|åˆ é™¤| F[åˆ é™¤åœ°å€]
        B -->|è®¾ä¸ºé»˜è®¤| G[è®¾ç½®é»˜è®¤åœ°å€]
    end
    
    subgraph åç«¯å¤„ç†
        C --> C1[ä»ThreadLocalè·å–userId]
        C1 --> C2[è®¾ç½®isDefault=0]
        C2 --> C3[æ’å…¥æ•°æ®åº“]
        
        G --> G1[å…ˆæŠŠè¯¥ç”¨æˆ·æ‰€æœ‰åœ°å€è®¾ä¸ºéé»˜è®¤]
        G1 --> G2[å†æŠŠå½“å‰åœ°å€è®¾ä¸ºé»˜è®¤]
    end
    
    subgraph æ•°æ®å±‚
        C3 --> DB[(address_bookè¡¨)]
        G2 --> DB
    end
```

### 1.2 æ ¸å¿ƒä»£ç è§£æ

**è®¾ç½®é»˜è®¤åœ°å€çš„å®ç°**ï¼ˆè¿™æ˜¯ä¸€ä¸ªç»å…¸çš„é¢è¯•è€ƒç‚¹ï¼‰ï¼š

```java
// AddressBookServiceImpl.java ç¬¬59-68è¡Œ
public void setDefault(AddressBook addressBook) {
    // ç¬¬ä¸€æ­¥ï¼šæŠŠè¯¥ç”¨æˆ·çš„æ‰€æœ‰åœ°å€éƒ½è®¾ä¸ºéé»˜è®¤
    addressBook.setIsDefault(0);
    addressBook.setUserId(BaseContext.getCurrentId());  // ä»ThreadLocalè·å–ç”¨æˆ·ID
    addressBookMapper.updateIsDefaultByUserId(addressBook);

    // ç¬¬äºŒæ­¥ï¼šæŠŠå½“å‰åœ°å€è®¾ä¸ºé»˜è®¤
    addressBook.setIsDefault(1);
    addressBookMapper.update(addressBook);
}
```

### 1.3 ğŸ¯ é¢è¯•è€ƒç‚¹

> **é¢è¯•å®˜å¸¸é—®ï¼šã€Œè®¾ç½®é»˜è®¤åœ°å€è¿™ä¸ªåŠŸèƒ½ï¼Œä½ æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿä¸ºä»€ä¹ˆè¦åˆ†ä¸¤æ­¥ï¼Ÿã€**

**æ ‡å‡†å›ç­”ï¼š**
1. å› ä¸ºæ•°æ®åº“ä¸­åªèƒ½æœ‰ä¸€ä¸ªé»˜è®¤åœ°å€ï¼Œæ‰€ä»¥éœ€è¦å…ˆ"å–æ¶ˆæ—§çš„"ï¼Œå†"è®¾ç½®æ–°çš„"
2. å…ˆæ‰§è¡Œ `UPDATE address_book SET is_default = 0 WHERE user_id = ?`
3. å†æ‰§è¡Œ `UPDATE address_book SET is_default = 1 WHERE id = ?`

**è¿½é—®1ï¼šã€Œè¿™ä¸¤æ­¥æ“ä½œéœ€è¦åŠ äº‹åŠ¡å—ï¼Ÿã€**
> âš ï¸ **ä½ çš„ä»£ç æœ‰é—®é¢˜ï¼** å½“å‰ `setDefault` æ–¹æ³• **æ²¡æœ‰åŠ  `@Transactional` æ³¨è§£**ï¼å¦‚æœç¬¬ä¸€æ­¥æˆåŠŸã€ç¬¬äºŒæ­¥å¤±è´¥ï¼Œä¼šå¯¼è‡´ç”¨æˆ·æ²¡æœ‰é»˜è®¤åœ°å€ï¼

**è¿½é—®2ï¼šã€Œèƒ½ä¸èƒ½ç”¨ä¸€æ¡SQLè§£å†³ï¼Ÿã€**
> å¯ä»¥ï¼Œä½†ä¼šæ›´å¤æ‚ã€‚MySQLæ”¯æŒ `CASE WHEN`ï¼š
> ```sql
> UPDATE address_book 
> SET is_default = CASE WHEN id = #{id} THEN 1 ELSE 0 END 
> WHERE user_id = #{userId}
> ```

---

## äºŒã€ç”¨æˆ·ä¸‹å•æ¨¡å—

### 2.1 ä¸šåŠ¡æµç¨‹å›¾

```mermaid
flowchart TB
    A[ç”¨æˆ·ç‚¹å‡»æäº¤è®¢å•] --> B{æ ¡éªŒæ”¶è´§åœ°å€}
    B -->|åœ°å€ä¸ºç©º| ERROR1[æŠ›å‡ºå¼‚å¸¸:åœ°å€ä¸ºç©º]
    B -->|åœ°å€å­˜åœ¨| C{æ£€æŸ¥é…é€èŒƒå›´}
    
    C -->|è¶…å‡ºèŒƒå›´| ERROR2[æŠ›å‡ºå¼‚å¸¸:è¶…å‡ºé…é€èŒƒå›´]
    C -->|èŒƒå›´å†…| D{æ ¡éªŒè´­ç‰©è½¦}
    
    D -->|è´­ç‰©è½¦ä¸ºç©º| ERROR3[æŠ›å‡ºå¼‚å¸¸:è´­ç‰©è½¦ä¸ºç©º]
    D -->|æœ‰å•†å“| E[æ„å»ºè®¢å•æ•°æ®]
    
    E --> F[ç”Ÿæˆè®¢å•å·<br/>System.currentTimeMillis]
    F --> G[è®¾ç½®è®¢å•çŠ¶æ€<br/>PENDING_PAYMENT]
    G --> H[æ’å…¥ordersè¡¨]
    H --> I[éå†è´­ç‰©è½¦]
    I --> J[æ„å»ºè®¢å•æ˜ç»†]
    J --> K[æ‰¹é‡æ’å…¥order_detailè¡¨]
    K --> L[æ¸…ç©ºè´­ç‰©è½¦]
    L --> M[è¿”å›OrderSubmitVO]
    
    style ERROR1 fill:#ff6b6b
    style ERROR2 fill:#ff6b6b
    style ERROR3 fill:#ff6b6b
```

### 2.2 æ ¸å¿ƒä»£ç è§£æ

```java
// OrderServiceImpl.java ç¬¬69-117è¡Œ
public OrderSubmitVO submitOrder(OrdersSubmitDTO ordersSubmitDTO) {
    // ========== 1. å‚æ•°æ ¡éªŒé˜¶æ®µ ==========
    // æ ¡éªŒåœ°å€æ˜¯å¦å­˜åœ¨
    AddressBook addressBook = addressBookMapper.getById(ordersSubmitDTO.getAddressBookId());
    if (addressBook == null) {
        throw new AddressBookBusinessException(MessageConstant.ADDRESS_BOOK_IS_NULL);
    }

    // è°ƒç”¨ç™¾åº¦åœ°å›¾APIæ£€æŸ¥é…é€èŒƒå›´ï¼ˆ5å…¬é‡Œå†…ï¼‰
    checkOutOfRange(addressBook.getCityName() + addressBook.getDistrictName() + addressBook.getDetail());

    // æ ¡éªŒè´­ç‰©è½¦æ˜¯å¦ä¸ºç©º
    Long currentId = BaseContext.getCurrentId();  // ThreadLocalè·å–ç”¨æˆ·ID
    ShoppingCart shoppingCart = new ShoppingCart();
    shoppingCart.setUserId(currentId);
    List<ShoppingCart> shoppingCartList = shoppingCartMapper.list(shoppingCart);
    if (shoppingCartList == null || shoppingCartList.size() == 0) {
        throw new ShoppingCartBusinessException(MessageConstant.SHOPPING_CART_IS_NULL);
    }

    // ========== 2. æ„å»ºè®¢å•æ•°æ® ==========
    Orders order = new Orders();
    BeanUtils.copyProperties(ordersSubmitDTO, order);  // DTO -> Entity
    order.setPhone(addressBook.getPhone());
    order.setAddress(addressBook.getDetail());
    order.setConsignee(addressBook.getConsignee());
    order.setNumber(String.valueOf(System.currentTimeMillis()));  // âš ï¸ è®¢å•å·ç”Ÿæˆ
    order.setUserId(currentId);
    order.setStatus(Orders.PENDING_PAYMENT);  // å¾…ä»˜æ¬¾çŠ¶æ€
    order.setPayStatus(Orders.UN_PAID);       // æœªæ”¯ä»˜
    order.setOrderTime(LocalDateTime.now());
    
    // ========== 3. æ•°æ®æŒä¹…åŒ– ==========
    orderMapper.insert(order);  // æ’å…¥è®¢å•ä¸»è¡¨

    // æ„å»ºè®¢å•æ˜ç»†
    ArrayList<OrderDetail> orderDetailList = new ArrayList<>();
    shoppingCartList.forEach(cart -> {
        OrderDetail orderDetail = new OrderDetail();
        BeanUtils.copyProperties(cart, orderDetail);
        orderDetail.setOrderId(order.getId());  // å…³è”è®¢å•ID
        orderDetailList.add(orderDetail);
    });
    orderDetailMapper.insertBatch(orderDetailList);  // æ‰¹é‡æ’å…¥æ˜ç»†è¡¨

    // ========== 4. æ¸…ç†è´­ç‰©è½¦ ==========
    shoppingCartMapper.deleteByUserId(currentId);

    // ========== 5. å°è£…è¿”å›ç»“æœ ==========
    return OrderSubmitVO.builder()
            .id(order.getId())
            .orderNumber(order.getNumber())
            .orderAmount(order.getAmount())
            .orderTime(order.getOrderTime())
            .build();
}
```

### 2.3 ğŸ¯ é¢è¯•è€ƒç‚¹

> **é¢è¯•å®˜å¸¸é—®ï¼šã€Œç”¨æˆ·ä¸‹å•è¿™ä¸ªæ¥å£ï¼Œä½ è€ƒè™‘è¿‡å“ªäº›å¼‚å¸¸æƒ…å†µï¼Ÿã€**

**æ ‡å‡†å›ç­”ï¼š**
1. åœ°å€ä¸ºç©º â†’ æŠ›å‡º `AddressBookBusinessException`
2. è¶…å‡ºé…é€èŒƒå›´ â†’ è°ƒç”¨ç™¾åº¦åœ°å›¾APIè®¡ç®—è·ç¦»
3. è´­ç‰©è½¦ä¸ºç©º â†’ æŠ›å‡º `ShoppingCartBusinessException`
4. åº“å­˜ä¸è¶³ â†’ **è¿™ä¸ªé¡¹ç›®æ²¡å®ç°ï¼é¢è¯•æ—¶è¦ä¸»åŠ¨è¯´å‡ºæ¥**

---

### âš ï¸ ä¸¥é‡é—®é¢˜ï¼æˆ‘å¿…é¡»æŒ‡å‡ºï¼š

**é—®é¢˜1ï¼šè®¢å•å·ç”¨æ—¶é—´æˆ³ç”Ÿæˆæœ‰ä¸¥é‡ç¼ºé™·ï¼**
```java
order.setNumber(String.valueOf(System.currentTimeMillis()));
```
- **å¹¶å‘åœºæ™¯ä¸‹ä¼šé‡å¤ï¼** ä¸¤ä¸ªç”¨æˆ·åŒä¸€æ¯«ç§’ä¸‹å•ï¼Œè®¢å•å·å°±é‡å¤äº†
- **é¢è¯•å¿…é—®ä¼˜åŒ–æ–¹æ¡ˆï¼š**
  - é›ªèŠ±ç®—æ³•ï¼ˆSnowflakeï¼‰
  - UUID
  - Redisè‡ªå¢ID + æ—¥æœŸå‰ç¼€
  - æ•°æ®åº“è‡ªå¢ID + ä¸šåŠ¡å‰ç¼€

**é—®é¢˜2ï¼šä¸‹å•æ–¹æ³•æ²¡æœ‰åŠ  `@Transactional` æ³¨è§£ï¼**
```java
// å½“å‰ä»£ç 
public OrderSubmitVO submitOrder(OrdersSubmitDTO ordersSubmitDTO) {
    // ...
    orderMapper.insert(order);           // æ­¥éª¤1ï¼šæ’å…¥è®¢å•
    orderDetailMapper.insertBatch(...);  // æ­¥éª¤2ï¼šæ’å…¥æ˜ç»†
    shoppingCartMapper.deleteByUserId(...); // æ­¥éª¤3ï¼šæ¸…ç©ºè´­ç‰©è½¦
}
```
> å¦‚æœæ­¥éª¤2æˆ–æ­¥éª¤3å¤±è´¥ï¼Œè®¢å•å·²ç»æ’å…¥ä½†æ•°æ®ä¸å®Œæ•´ï¼**å¿…é¡»åŠ äº‹åŠ¡ï¼**

---

## ä¸‰ã€è®¢å•æ”¯ä»˜æ¨¡å—

### 3.1 ä¸šåŠ¡æµç¨‹å›¾

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·/å°ç¨‹åº
    participant S as åç«¯Server
    participant W as å¾®ä¿¡æ”¯ä»˜
    participant WS as WebSocket
    participant A as ç®¡ç†ç«¯

    U->>S: 1. è°ƒç”¨æ”¯ä»˜æ¥å£(è®¢å•å·)
    S->>S: 2. æ ¹æ®è®¢å•å·æŸ¥è¯¢è®¢å•ä¿¡æ¯
    S->>W: 3. è°ƒç”¨å¾®ä¿¡é¢„æ”¯ä»˜API
    W-->>S: 4. è¿”å›prepay_id
    S-->>U: 5. è¿”å›æ”¯ä»˜å‚æ•°(ç­¾åç­‰)
    
    U->>W: 6. ç”¨æˆ·ç¡®è®¤æ”¯ä»˜
    W->>W: 7. æ‰£æ¬¾å¤„ç†
    W-->>U: 8. æ”¯ä»˜ç»“æœ
    
    W->>S: 9. æ”¯ä»˜æˆåŠŸå›è°ƒ(å¼‚æ­¥)
    S->>S: 10. ä¿®æ”¹è®¢å•çŠ¶æ€ä¸º"å¾…æ¥å•"
    S->>WS: 11. æ¨é€æ–°è®¢å•é€šçŸ¥
    WS->>A: 12. ç®¡ç†ç«¯æ”¶åˆ°æé†’
```

### 3.2 æ ¸å¿ƒä»£ç è§£æ

**æ”¯ä»˜æ¥å£ï¼š**
```java
// OrderServiceImpl.java ç¬¬126-150è¡Œ
public OrderPaymentVO payment(OrdersPaymentDTO ordersPaymentDTO) throws Exception {
    Long userId = BaseContext.getCurrentId();
    User user = userMapper.getById(String.valueOf(userId));

    String orderNumber = ordersPaymentDTO.getOrderNumber();
    Orders orders = orderMapper.getByNumberAndUserId(orderNumber, userId);

    // è°ƒç”¨å¾®ä¿¡æ”¯ä»˜æ¥å£ï¼Œç”Ÿæˆé¢„æ”¯ä»˜äº¤æ˜“å•
    JSONObject jsonObject = weChatPayUtil.pay(
            ordersPaymentDTO.getOrderNumber(),  // å•†æˆ·è®¢å•å·
            orders.getAmount(),                  // é‡‘é¢
            "è‹ç©¹å¤–å–è®¢å•" + orders.getId(),      // å•†å“æè¿°
            user.getOpenid()                     // ç”¨æˆ·openid
    );

    // åˆ¤æ–­æ˜¯å¦å·²æ”¯ä»˜
    if (jsonObject.getString("code") != null && 
        jsonObject.getString("code").equals("ORDERPAID")) {
        throw new OrderBusinessException("è¯¥è®¢å•å·²æ”¯ä»˜");
    }

    OrderPaymentVO vo = jsonObject.toJavaObject(OrderPaymentVO.class);
    vo.setPackageStr(jsonObject.getString("package"));
    return vo;
}
```

**æ”¯ä»˜æˆåŠŸå›è°ƒï¼š**
```java
// OrderServiceImpl.java ç¬¬158-180è¡Œ
public void paySuccess(String outTradeNo) {
    Long userId = BaseContext.getCurrentId();
    Orders orderDB = orderMapper.getByNumberAndUserId(outTradeNo, userId);

    // æ›´æ–°è®¢å•çŠ¶æ€
    Orders orders = Orders.builder()
            .id(orderDB.getId())
            .status(Orders.TO_BE_CONFIRMED)  // å¾…æ¥å•
            .payStatus(Orders.PAID)          // å·²æ”¯ä»˜
            .checkoutTime(LocalDateTime.now())
            .build();
    orderMapper.update(orders);

    // ========== WebSocketæ¨é€æ–°è®¢å•æé†’ ==========
    HashMap map = new HashMap();
    map.put("type", 1);  // 1=æ–°è®¢å• 2=å‚¬å•
    map.put("orderId", orders.getId());
    map.put("content", "è®¢å•å·ï¼š" + outTradeNo);
    webSocketServer.sendToAllClient(JSON.toJSONString(map));
}
```

### 3.3 ğŸ¯ é¢è¯•è€ƒç‚¹

> **é¢è¯•å®˜å¸¸é—®ï¼šã€Œå¾®ä¿¡æ”¯ä»˜çš„æµç¨‹æ˜¯æ€æ ·çš„ï¼Ÿä¸ºä»€ä¹ˆè¦ç”¨å›è°ƒï¼Ÿã€**

**æ ‡å‡†å›ç­”ï¼š**

| æ­¥éª¤ | è¯´æ˜ |
|------|------|
| 1. é¢„æ”¯ä»˜ | åç«¯è°ƒç”¨å¾®ä¿¡APIï¼Œè·å– `prepay_id` |
| 2. ç­¾å | åç«¯ç”¨ç§é’¥å¯¹å‚æ•°ç­¾åï¼Œè¿”å›ç»™å‰ç«¯ |
| 3. å”¤èµ·æ”¯ä»˜ | å‰ç«¯ç”¨ç­¾åå”¤èµ·å¾®ä¿¡æ”¯ä»˜ |
| 4. å›è°ƒé€šçŸ¥ | å¾®ä¿¡å¼‚æ­¥é€šçŸ¥åç«¯æ”¯ä»˜ç»“æœ |

**ä¸ºä»€ä¹ˆç”¨å›è°ƒè€Œä¸æ˜¯è½®è¯¢ï¼Ÿ**
- ç”¨æˆ·å¯èƒ½å…³æ‰é¡µé¢ï¼Œä½†æ”¯ä»˜å¯èƒ½æˆåŠŸ
- ç½‘ç»œåŸå› å¯¼è‡´å‰ç«¯æ²¡æ”¶åˆ°ç»“æœ
- å›è°ƒæ˜¯å¾®ä¿¡å®˜æ–¹æ¨èçš„å¯é æ–¹å¼

**è¿½é—®1ï¼šã€Œå›è°ƒæ¥å£æ€ä¹ˆä¿è¯å®‰å…¨æ€§ï¼Ÿã€**
- éªŒè¯ç­¾åï¼ˆå¾®ä¿¡ç”¨ç§é’¥ç­¾åï¼Œæˆ‘ä»¬ç”¨å…¬é’¥éªŒè¯ï¼‰
- éªŒè¯è®¢å•é‡‘é¢æ˜¯å¦åŒ¹é…
- å¹‚ç­‰å¤„ç†ï¼ˆåŒä¸€è®¢å•å¤šæ¬¡å›è°ƒåªå¤„ç†ä¸€æ¬¡ï¼‰

**è¿½é—®2ï¼šã€Œå¦‚æœå›è°ƒå¤±è´¥äº†æ€ä¹ˆåŠï¼Ÿã€**
- å¾®ä¿¡ä¼šé‡è¯•ï¼ˆæœ€å¤š15æ¬¡ï¼Œé—´éš”é€’å¢ï¼‰
- åç«¯éœ€è¦åšå¹‚ç­‰å¤„ç†
- å¯ä»¥åšå®šæ—¶ä»»åŠ¡ä¸»åŠ¨æŸ¥è¯¢æœªæ”¯ä»˜è®¢å•

---

## å››ã€è®¢å•çŠ¶æ€æœº

```mermaid
stateDiagram-v2
    [*] --> å¾…ä»˜æ¬¾: ç”¨æˆ·ä¸‹å•
    å¾…ä»˜æ¬¾ --> å¾…æ¥å•: æ”¯ä»˜æˆåŠŸ
    å¾…ä»˜æ¬¾ --> å·²å–æ¶ˆ: ç”¨æˆ·å–æ¶ˆ/è¶…æ—¶å–æ¶ˆ
    
    å¾…æ¥å• --> å·²æ¥å•: å•†å®¶æ¥å•
    å¾…æ¥å• --> å·²å–æ¶ˆ: å•†å®¶æ‹’å•(éœ€é€€æ¬¾)
    
    å·²æ¥å• --> æ´¾é€ä¸­: å•†å®¶æ´¾é€
    æ´¾é€ä¸­ --> å·²å®Œæˆ: é€è¾¾
    
    å·²å–æ¶ˆ --> [*]
    å·²å®Œæˆ --> [*]
```

---

## äº”ã€ThreadLocal æ ¸å¿ƒè€ƒç‚¹

```java
// BaseContext.java
public class BaseContext {
    public static ThreadLocal<Long> threadLocal = new ThreadLocal<>();

    public static void setCurrentId(Long id) {
        threadLocal.set(id);
    }

    public static Long getCurrentId() {
        return threadLocal.get();
    }

    public static void removeCurrentId() {
        threadLocal.remove();
    }
}
```

### ğŸ¯ é¢è¯•é«˜é¢‘é¢˜

> **ã€ŒThreadLocalæ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆç”¨å®ƒå­˜ç”¨æˆ·IDï¼Ÿã€**

**å›ç­”è¦ç‚¹ï¼š**
1. ThreadLocal æ˜¯çº¿ç¨‹æœ¬åœ°å˜é‡ï¼Œæ¯ä¸ªçº¿ç¨‹æœ‰ç‹¬ç«‹å‰¯æœ¬
2. HTTPè¯·æ±‚ = ä¸€ä¸ªçº¿ç¨‹ï¼Œæ•´ä¸ªè¯·æ±‚é“¾è·¯å¯ä»¥å…±äº«ç”¨æˆ·ID
3. é¿å…åœ¨æ–¹æ³•å‚æ•°ä¸­å±‚å±‚ä¼ é€’ userId

> **è¿½é—®ï¼šã€ŒThreadLocalä¼šå†…å­˜æ³„æ¼å—ï¼Ÿæ€ä¹ˆè§£å†³ï¼Ÿã€**

**å…³é”®ç‚¹ï¼š**
- ThreadLocalMap çš„ key æ˜¯å¼±å¼•ç”¨ï¼Œä½† value æ˜¯å¼ºå¼•ç”¨
- çº¿ç¨‹æ± åœºæ™¯ä¸‹çº¿ç¨‹å¤ç”¨ï¼Œvalue ä¸ä¼šè¢«å›æ”¶
- **è§£å†³æ–¹æ¡ˆï¼šç”¨å®Œå¿…é¡»è°ƒç”¨ `remove()`**

> âš ï¸ **ä½ çš„ä»£ç æ½œåœ¨é—®é¢˜ï¼š** éœ€è¦åœ¨æ‹¦æˆªå™¨çš„ `afterCompletion` ä¸­è°ƒç”¨ `BaseContext.removeCurrentId()` é¿å…å†…å­˜æ³„æ¼ï¼

---

## å…­ã€é«˜å¹¶å‘ä¼˜åŒ–å»ºè®®

| å½“å‰å®ç° | ç”Ÿäº§ç¯å¢ƒä¼˜åŒ– |
|---------|-------------|
| è®¢å•å·ç”¨æ—¶é—´æˆ³ | **é›ªèŠ±ç®—æ³•** æˆ– **Redisè‡ªå¢+æ—¥æœŸå‰ç¼€** |
| æ²¡æœ‰åº“å­˜æ ¡éªŒ | **Redisé¢„å‡åº“å­˜ + æ•°æ®åº“æœ€ç»ˆæ‰£å‡** |
| æ²¡æœ‰åˆ†å¸ƒå¼é” | **Redissonåˆ†å¸ƒå¼é”** é˜²æ­¢è¶…å– |
| åŒæ­¥ä¸‹å• | **æ¶ˆæ¯é˜Ÿåˆ—å¼‚æ­¥ä¸‹å•** å‰Šå³°å¡«è°· |
| ç›´æ¥æŸ¥è¯¢æ•°æ®åº“ | **Redisç¼“å­˜çƒ­ç‚¹æ•°æ®** |

---

**ä½ æƒ³æ·±å…¥äº†è§£å“ªä¸ªéƒ¨åˆ†ï¼Ÿ** æ¯”å¦‚ï¼š
1. ã€Œè¯¦ç»†è®²è§£ä¸€ä¸‹WebSocketæ˜¯æ€ä¹ˆå®ç°è®¢å•æé†’çš„ã€
2. ã€Œç»™æˆ‘è®²è®²äº‹åŠ¡å¤±æ•ˆçš„å‡ ç§åœºæ™¯ã€
3. ã€Œå¸®æˆ‘çœ‹çœ‹è´­ç‰©è½¦æ¨¡å—çš„Rediså®ç°ã€